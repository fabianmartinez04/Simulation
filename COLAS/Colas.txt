/*
Tecnológico de Costa Rica
Curso de Simulación 
Tarea programada de Inventario con Colas
Fabian Martínez Valverde 2019061575
Gustavo Blanco Alfaro 2019063503

Solución con:

3 empleados:
4 empleados:
5 empleados:
6 empleados:

*/


'Función para obtener la cantidad de camiones en espera al inicio de la simulación
newcmd obtenerCamionesEspera cantidad
	copy 50#0 25#1 15#2 10#3 tabla
	sample 1 tabla cantidad
end



'Función para obtener la media según la cantidad de empleados
newcmd obtenerMedia empleados media
	if empleados = 3
		media = 37
	elseif empleados = 4
		media = 35
	elseif empleados = 5
		media = 33
	elseif empleados = 6
		media = 31
	else
		media = -1
	end
end


'Función para obtener la siguiente entrada de un camión
newcmd obtenerEntrada tiempo
   exponential 1 40 tiempo
   integer ceiling tiempo tiempo
end


'Función para obtener la salida de un camión según la cantidad de empleados
newcmd obtenerSalida promedio tiempo
   exponential 1 promedio tiempo
   integer ceiling tiempo tiempo
end









/***********************************************************************
			MAIN
***********************************************************************/

clearoutput

input "Cantidad de empleados: " empleados

obtenerMedia empleados media

if media = -1
	print "Los empleados deben ser de 3 a 6"
else

	obtenerCamionesEspera contCamiones
	print contCamiones


	'Preparación de listas
	Tiempo = ()
	Evento = ()
	Tiempo_Sig_Sal = ()
	Cola = ()
	Tiempo_Sig_Ent = ()
	Tiempo_Ocioso_Personal = ()
	Tiempo_Ocioso_Buses = ()


	'Preparación de variables
	TiempoActual = 0
	STRING "Inicio" EventoActual
	Tiempo_Sig_SalActual = 0
	ColaActual = ()
	Tiempo_Sig_EntActual = 0
	Tiempo_Ocioso_PersonalActual = 0
	Tiempo_Ocioso_BusesActual = 0

	STRING "Salida" sSalida
	STRING "Entrada" sEntrada

	tamColaActual = 0
	

	until Tiempo_Sig_EntActual >= 480 AND tamColaActual = 0

		size ColaActual tamColaActual

		STRING_COMPARE EventoActual "Salida" esSalida

		if esSalida <> 0
			obtenerEntrada Tiempo_Sig_EntActual
		end
		
		concat Tiempo_Sig_End Tiempo_Sig_EntActual Tiempo_Sig_End


		if contCamiones <> 0
			obtenerSalida media Tiempo_Sig_SalActual
		else
			STRING "x" Tiempo_Sig_SalActual
		end

		concat Tiempo_Sig_Sal Tiempo_Sig_SalActual Tiempo_Sig_Sal

		Tiempo_Sig_EntActual = Tiempo_Sig_EntActual + 100
		print Tiempo_Sig_EntActual

	end

	print table Tiempo Evento Tiempo_Sig_Sal Tiempo_Sig_Ent Tiempo_Ocioso_Personal 	Tiempo_Ocioso_Buses Cola

end






